geom_line(aes(y=`Exchange-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(3, 8, by = 1))
ggplot(data=consumerconfidenceindex,aes(x=Date,group=1))+
geom_line(aes(y=`Consumer-confidence-index`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(75, 100, by = 5))
fit_month<-lm (`Second-hand-sales`~`Interest-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`,secondhandsales)
summary(fit_month)
secondhandsales[,trend_comp:=1:.N]
secondhandsales[,Year:=year(Date)]
secondhandsales[,Month:=as.factor(month(Date))]
secondhandsales[64:65,is_festival:=1]
secondhandsales[is.na(is_festival)==T,is_festival:=0]
secondhandsales
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+`Exchange-rates`+as.factor(Month)+Year+trend_comp+as.factor(is_festival),secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
acf(secondhandsales[,2],lag.max = 24)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Exchange-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Interest-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Consumer-confidence-index`)
plot(secondhandsales[,list(`Second-hand-sales`,interestrates)])
plot(secondhandsales[,list(`Second-hand-sales`,exchangerates)])
plot(secondhandsales[,list(`Second-hand-sales`,consumerconfidenceindex)])
plot(secondhandsales[,list(`Second-hand-sales`,residual=fit_month$residual)])
secondhandsales[,fitted:=fitted(fit_month)]
secondhandsales[,residual:=residuals(fit_month)]
t12 <- "2020-12-01"
secondhandsales <- rbind(secondhandsales,data.table(Date = as.Date(t12)),fill = TRUE)
secondhandsales[,fitted:=fitted(fit_month)]
library(data.table,quietly = TRUE,warn.conflicts = FALSE)
library(ggplot2,quietly = TRUE,warn.conflicts = FALSE)
library(lubridate,quietly = TRUE,warn.conflicts = FALSE)
library(zoo,quietly = TRUE,warn.conflicts = FALSE)
secondhandsales<-fread("D:/Boğaziçi/İe360/data/hw3/second-hand-sales.csv",drop="V3")
interestrates<-fread("D:/Boğaziçi/İe360/data/hw3/interest-rates.csv",drop="V3")
exchangerates<-fread("D:/Boğaziçi/İe360/data/hw3/exchange-rates.csv",drop="V3")
consumerconfidenceindex<-fread("D:/Boğaziçi/İe360/data/hw3/consumer-confidence-index.csv",drop="V3")
secondhandsales[,Date:=as.Date(paste(Date,"-01",sep=""))]
interestrates[,Date:=as.Date(paste(Date,"-01",sep=""))]
exchangerates[,Date:=as.Date(paste(Date,"-01",sep=""))]
consumerconfidenceindex[,Date:=as.Date(paste(Date,"-01",sep=""))]
secondhandsales$`Interest-rates`<-interestrates[,2]
secondhandsales$`Exchange-rates`<-exchangerates[,2]
secondhandsales$`Consumer-confidence-index`<-consumerconfidenceindex[,2]
month=seq(1,12,by=1)
secondhandsales<-cbind(secondhandsales,month)
secondhandsales
ggplot(data=secondhandsales,aes(x=Date,group=1))+
geom_line(aes(y=`Second-hand-sales`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(40000, 160000, by = 20000))
ggplot(data=interestrates,aes(x=Date,group=1))+
geom_line(aes(y=`Interest-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(10, 40, by = 5))
ggplot(data=exchangerates,aes(x=Date,group=1))+
geom_line(aes(y=`Exchange-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(3, 8, by = 1))
ggplot(data=consumerconfidenceindex,aes(x=Date,group=1))+
geom_line(aes(y=`Consumer-confidence-index`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(75, 100, by = 5))
fit_month<-lm (`Second-hand-sales`~`Interest-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`,secondhandsales)
summary(fit_month)
secondhandsales[,trend_comp:=1:.N]
secondhandsales[,Year:=year(Date)]
secondhandsales[,Month:=as.factor(month(Date))]
secondhandsales[64:65,is_festival:=1]
secondhandsales[is.na(is_festival)==T,is_festival:=0]
secondhandsales
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+`Exchange-rates`+as.factor(Month)+Year+trend_comp+as.factor(is_festival),secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
acf(secondhandsales[,2],lag.max = 24)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Exchange-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Interest-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Consumer-confidence-index`)
plot(secondhandsales[,list(`Second-hand-sales`,interestrates)])
plot(secondhandsales[,list(`Second-hand-sales`,exchangerates)])
plot(secondhandsales[,list(`Second-hand-sales`,consumerconfidenceindex)])
plot(secondhandsales[,list(`Second-hand-sales`,residual=fit_month$residual)])
secondhandsales[,fitted:=fitted(fit_month)]
secondhandsales[,residual:=residuals(fit_month)]
t12 <- "2020-12-01"
secondhandsales <- rbind(secondhandsales,data.table(Date = as.Date(t12)),fill = TRUE)
secondhandsales[.N,is_festival:=0]
secondhandsales[.N,trend_comp:=72]
secondhandsales[.N,Month:=12]
secondhandsales[.N,Year:=2020]
secondhandsales[.N,`Interest-rates`:= secondhandsales[.N-1,`Interest-rates`]]
secondhandsales[.N,`Exchange-rates`:= secondhandsales[.N-1,`Exchange-rates`]]
secondhandsales[.N,`Consumer-confidence-index`:=secondhandsales[.N-1,`Consumer-confidence-index`]]
tail(secondhandsales)
predict(fit_month,secondhandsales[is.na(fitted)==T])
secondhandsales[is.na(fitted)==T,fitted:=predict(fit_month,secondhandsales[is.na(fitted)==T])]
cols <- c("predicted" = "orange", "actual" = "black")
ggplot() +
geom_line(data = secondhandsales, aes(x = trend_comp, y = fitted,color = "predicted")) +
geom_line(data = secondhandsales, aes(x = trend_comp, y = `Second-hand-sales`,color = "actual")) +
xlab('Date(months)') +
ylab('Second hand sales') +
scale_color_manual(values = cols)
ggplot() +
geom_line(data = secondhandsales, aes(x = trend_comp, y = predicted_sales,color = "predicted")) +
geom_line(data = secondhandsales, aes(x = trend_comp, y = actual_sales,color = "actual")) +
xlab('Date(months)') +
ylab('Second hand sales') +
scale_color_manual(values = cols)
library(data.table,quietly = TRUE,warn.conflicts = FALSE)
library(ggplot2,quietly = TRUE,warn.conflicts = FALSE)
library(lubridate,quietly = TRUE,warn.conflicts = FALSE)
library(zoo,quietly = TRUE,warn.conflicts = FALSE)
secondhandsales<-fread("D:/Boğaziçi/İe360/data/hw3/second-hand-sales.csv",drop="V3")
interestrates<-fread("D:/Boğaziçi/İe360/data/hw3/interest-rates.csv",drop="V3")
exchangerates<-fread("D:/Boğaziçi/İe360/data/hw3/exchange-rates.csv",drop="V3")
consumerconfidenceindex<-fread("D:/Boğaziçi/İe360/data/hw3/consumer-confidence-index.csv",drop="V3")
secondhandsales[,Date:=as.Date(paste(Date,"-01",sep=""))]
interestrates[,Date:=as.Date(paste(Date,"-01",sep=""))]
exchangerates[,Date:=as.Date(paste(Date,"-01",sep=""))]
consumerconfidenceindex[,Date:=as.Date(paste(Date,"-01",sep=""))]
secondhandsales$`Interest-rates`<-interestrates[,2]
secondhandsales$`Exchange-rates`<-exchangerates[,2]
secondhandsales$`Consumer-confidence-index`<-consumerconfidenceindex[,2]
month=seq(1,12,by=1)
secondhandsales<-cbind(secondhandsales,month)
secondhandsales
ggplot(data=secondhandsales,aes(x=Date,group=1))+
geom_line(aes(y=`Second-hand-sales`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(40000, 160000, by = 20000))
ggplot(data=interestrates,aes(x=Date,group=1))+
geom_line(aes(y=`Interest-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(10, 40, by = 5))
ggplot(data=exchangerates,aes(x=Date,group=1))+
geom_line(aes(y=`Exchange-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(3, 8, by = 1))
ggplot(data=consumerconfidenceindex,aes(x=Date,group=1))+
geom_line(aes(y=`Consumer-confidence-index`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(75, 100, by = 5))
fit_month<-lm (`Second-hand-sales`~`Interest-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`,secondhandsales)
summary(fit_month)
secondhandsales[,trend_comp:=1:.N]
secondhandsales[,Year:=year(Date)]
secondhandsales[,Month:=as.factor(month(Date))]
secondhandsales[64:65,is_festival:=1]
secondhandsales[is.na(is_festival)==T,is_festival:=0]
secondhandsales
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+`Exchange-rates`+as.factor(Month)+Year+trend_comp+as.factor(is_festival),secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
acf(secondhandsales[,2],lag.max = 24)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Exchange-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Interest-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Consumer-confidence-index`)
plot(secondhandsales[,list(`Second-hand-sales`,interestrates)])
plot(secondhandsales[,list(`Second-hand-sales`,exchangerates)])
plot(secondhandsales[,list(`Second-hand-sales`,consumerconfidenceindex)])
plot(secondhandsales[,list(`Second-hand-sales`,residual=fit_month$residual)])
secondhandsales[,fitted:=fitted(fit_month)]
secondhandsales[,residual:=residuals(fit_month)]
t12 <- "2020-12-01"
secondhandsales <- rbind(secondhandsales,data.table(Date = as.Date(t12)),fill = TRUE)
secondhandsales[.N,is_festival:=0]
secondhandsales[.N,trend_comp:=72]
secondhandsales[.N,Month:=12]
secondhandsales[.N,Year:=2020]
secondhandsales[.N,`Interest-rates`:= secondhandsales[.N-1,`Interest-rates`]]
secondhandsales[.N,`Exchange-rates`:= secondhandsales[.N-1,`Exchange-rates`]]
secondhandsales[.N,`Consumer-confidence-index`:=secondhandsales[.N-1,`Consumer-confidence-index`]]
predict(fit_month,secondhandsales[is.na(fitted)==T])
secondhandsales[is.na(fitted)==T,fitted:=predict(fit_month,secondhandsales[is.na(fitted)==T])]
cols <- c("predicted" = "orange", "actual" = "black")
ggplot() +
geom_line(data = secondhandsales, aes(x = trend_comp, y = fitted,color = "predicted")) +
geom_line(data = secondhandsales, aes(x = trend_comp, y = `Second-hand-sales`,color = "actual")) +
xlab('Date(months)') +
ylab('Second hand sales') +
scale_color_manual(values = cols)
tail(secondhandsales)
library(data.table,quietly = TRUE,warn.conflicts = FALSE)
library(ggplot2,quietly = TRUE,warn.conflicts = FALSE)
library(lubridate,quietly = TRUE,warn.conflicts = FALSE)
library(zoo,quietly = TRUE,warn.conflicts = FALSE)
secondhandsales<-fread("D:/Boğaziçi/İe360/data/hw3/second-hand-sales.csv",drop="V3")
interestrates<-fread("D:/Boğaziçi/İe360/data/hw3/interest-rates.csv",drop="V3")
exchangerates<-fread("D:/Boğaziçi/İe360/data/hw3/exchange-rates.csv",drop="V3")
consumerconfidenceindex<-fread("D:/Boğaziçi/İe360/data/hw3/consumer-confidence-index.csv",drop="V3")
secondhandsales[,Date:=as.Date(paste(Date,"-01",sep=""))]
interestrates[,Date:=as.Date(paste(Date,"-01",sep=""))]
exchangerates[,Date:=as.Date(paste(Date,"-01",sep=""))]
consumerconfidenceindex[,Date:=as.Date(paste(Date,"-01",sep=""))]
secondhandsales$`Interest-rates`<-interestrates[,2]
secondhandsales$`Exchange-rates`<-exchangerates[,2]
secondhandsales$`Consumer-confidence-index`<-consumerconfidenceindex[,2]
month=seq(1,12,by=1)
secondhandsales<-cbind(secondhandsales,month)
secondhandsales
ggplot(data=secondhandsales,aes(x=Date,group=1))+
geom_line(aes(y=`Second-hand-sales`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(40000, 160000, by = 20000))
ggplot(data=interestrates,aes(x=Date,group=1))+
geom_line(aes(y=`Interest-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(10, 40, by = 5))
ggplot(data=exchangerates,aes(x=Date,group=1))+
geom_line(aes(y=`Exchange-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(3, 8, by = 1))
ggplot(data=consumerconfidenceindex,aes(x=Date,group=1))+
geom_line(aes(y=`Consumer-confidence-index`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(75, 100, by = 5))
fit_month<-lm (`Second-hand-sales`~`Interest-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`,secondhandsales)
summary(fit_month)
secondhandsales[,trend_comp:=1:.N]
secondhandsales[,Year:=year(Date)]
secondhandsales[,Month:=as.factor(month(Date))]
secondhandsales[64:65,is_festival:=1]
secondhandsales[is.na(is_festival)==T,is_festival:=0]
secondhandsales
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+`Exchange-rates`+as.factor(Month)+Year+trend_comp+as.factor(is_festival),secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
acf(secondhandsales[,2],lag.max = 24)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Exchange-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Interest-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Consumer-confidence-index`)
plot(secondhandsales[,list(`Second-hand-sales`,interestrates)])
plot(secondhandsales[,list(`Second-hand-sales`,exchangerates)])
plot(secondhandsales[,list(`Second-hand-sales`,consumerconfidenceindex)])
plot(secondhandsales[,list(`Second-hand-sales`,residual=fit_month$residual)])
secondhandsales[,fitted:=fitted(fit_month)]
secondhandsales[,residual:=residuals(fit_month)]
t12 <- "2020-12-01"
secondhandsales <- rbind(secondhandsales,data.table(Date = as.Date(t12)),fill = TRUE)
secondhandsales[.N,is_festival:=0]
secondhandsales[.N,trend_comp:=72]
secondhandsales[.N,Month:=12]
secondhandsales[.N,Year:=2020]
secondhandsales[.N,`Interest-rates`:= secondhandsales[.N-1,`Interest-rates`]]
secondhandsales[.N,`Exchange-rates`:= secondhandsales[.N-1,`Exchange-rates`]]
secondhandsales[.N,`Consumer-confidence-index`:=secondhandsales[.N-1,`Consumer-confidence-index`]]
predict(fit_month,secondhandsales[is.na(fitted)==T])
secondhandsales[is.na(fitted)==T,fitted:=predict(fit_month,secondhandsales[is.na(fitted)==T])]
cols <- c("predicted" = "orange", "actual" = "black")
ggplot() +
geom_line(data = secondhandsales, aes(x = trend_comp, y = fitted,color = "predicted")) +
geom_line(data = secondhandsales, aes(x = trend_comp, y = `Second-hand-sales`,color = "actual")) +
xlab('Date(months)') +
ylab('Second hand sales') +
scale_color_manual(values = cols)
tail(secondhandsales)
library(data.table,quietly = TRUE,warn.conflicts = FALSE)
library(ggplot2,quietly = TRUE,warn.conflicts = FALSE)
library(lubridate,quietly = TRUE,warn.conflicts = FALSE)
library(zoo,quietly = TRUE,warn.conflicts = FALSE)
secondhandsales<-fread("D:/Boğaziçi/İe360/data/hw3/second-hand-sales.csv",drop="V3")
interestrates<-fread("D:/Boğaziçi/İe360/data/hw3/interest-rates.csv",drop="V3")
exchangerates<-fread("D:/Boğaziçi/İe360/data/hw3/exchange-rates.csv",drop="V3")
consumerconfidenceindex<-fread("D:/Boğaziçi/İe360/data/hw3/consumer-confidence-index.csv",drop="V3")
secondhandsales[,Date:=as.Date(paste(Date,"-01",sep=""))]
interestrates[,Date:=as.Date(paste(Date,"-01",sep=""))]
exchangerates[,Date:=as.Date(paste(Date,"-01",sep=""))]
consumerconfidenceindex[,Date:=as.Date(paste(Date,"-01",sep=""))]
secondhandsales$`Interest-rates`<-interestrates[,2]
secondhandsales$`Exchange-rates`<-exchangerates[,2]
secondhandsales$`Consumer-confidence-index`<-consumerconfidenceindex[,2]
month=seq(1,12,by=1)
secondhandsales<-cbind(secondhandsales,month)
secondhandsales
ggplot(data=secondhandsales,aes(x=Date,group=1))+
geom_line(aes(y=`Second-hand-sales`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(40000, 160000, by = 20000))
ggplot(data=interestrates,aes(x=Date,group=1))+
geom_line(aes(y=`Interest-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(10, 40, by = 5))
ggplot(data=exchangerates,aes(x=Date,group=1))+
geom_line(aes(y=`Exchange-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(3, 8, by = 1))
ggplot(data=consumerconfidenceindex,aes(x=Date,group=1))+
geom_line(aes(y=`Consumer-confidence-index`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(75, 100, by = 5))
fit_month<-lm (`Second-hand-sales`~`Interest-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`,secondhandsales)
summary(fit_month)
secondhandsales[,trend_comp:=1:.N]
secondhandsales[,Year:=year(Date)]
secondhandsales[,Month:=as.factor(month(Date))]
secondhandsales[64:65,is_festival:=1]
secondhandsales[is.na(is_festival)==T,is_festival:=0]
secondhandsales
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+`Exchange-rates`+as.factor(Month)+Year+trend_comp+as.factor(is_festival),secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+`Exchange-rates`+as.factor(Month)+Year+as.factor(is_festival),secondhandsales)
summary(fit_month)
plot(fit_month$residual)
acf(secondhandsales[,2],lag.max = 24)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Exchange-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Interest-rates`)
#ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Consumer-confidence-index`)
plot(secondhandsales[,list(`Second-hand-sales`,interestrates)])
plot(secondhandsales[,list(`Second-hand-sales`,exchangerates)])
plot(secondhandsales[,list(`Second-hand-sales`,consumerconfidenceindex)])
plot(secondhandsales[,list(`Second-hand-sales`,residual=fit_month$residual)])
secondhandsales[,fitted:=fitted(fit_month)]
secondhandsales[,residual:=residuals(fit_month)]
t12 <- "2020-12-01"
secondhandsales <- rbind(secondhandsales,data.table(Date = as.Date(t12)),fill = TRUE)
secondhandsales[.N,is_festival:=0]
secondhandsales[.N,trend_comp:=72]
secondhandsales[.N,Month:=12]
secondhandsales[.N,Year:=2020]
secondhandsales[.N,`Interest-rates`:= secondhandsales[.N-1,`Interest-rates`]]
secondhandsales[.N,`Exchange-rates`:= secondhandsales[.N-1,`Exchange-rates`]]
secondhandsales[.N,`Consumer-confidence-index`:=secondhandsales[.N-1,`Consumer-confidence-index`]]
predict(fit_month,secondhandsales[is.na(fitted)==T])
secondhandsales[is.na(fitted)==T,fitted:=predict(fit_month,secondhandsales[is.na(fitted)==T])]
cols <- c("predicted" = "orange", "actual" = "black")
ggplot() +
geom_line(data = secondhandsales, aes(x = trend_comp, y = fitted,color = "predicted")) +
geom_line(data = secondhandsales, aes(x = trend_comp, y = `Second-hand-sales`,color = "actual")) +
xlab('Date(months)') +
ylab('Second hand sales') +
scale_color_manual(values = cols)
tail(secondhandsales)
library(data.table,quietly = TRUE,warn.conflicts = FALSE)
library(ggplot2,quietly = TRUE,warn.conflicts = FALSE)
library(lubridate,quietly = TRUE,warn.conflicts = FALSE)
library(zoo,quietly = TRUE,warn.conflicts = FALSE)
secondhandsales<-fread("D:/Boğaziçi/İe360/data/hw3/second-hand-sales.csv",drop="V3")
interestrates<-fread("D:/Boğaziçi/İe360/data/hw3/interest-rates.csv",drop="V3")
exchangerates<-fread("D:/Boğaziçi/İe360/data/hw3/exchange-rates.csv",drop="V3")
consumerconfidenceindex<-fread("D:/Boğaziçi/İe360/data/hw3/consumer-confidence-index.csv",drop="V3")
secondhandsales[,Date:=as.Date(paste(Date,"-01",sep=""))]
interestrates[,Date:=as.Date(paste(Date,"-01",sep=""))]
exchangerates[,Date:=as.Date(paste(Date,"-01",sep=""))]
consumerconfidenceindex[,Date:=as.Date(paste(Date,"-01",sep=""))]
secondhandsales$`Interest-rates`<-interestrates[,2]
secondhandsales$`Exchange-rates`<-exchangerates[,2]
secondhandsales$`Consumer-confidence-index`<-consumerconfidenceindex[,2]
ggplot(data=secondhandsales,aes(x=Date,group=1))+
geom_line(aes(y=`Second-hand-sales`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(40000, 160000, by = 20000))
ggplot(data=interestrates,aes(x=Date,group=1))+
geom_line(aes(y=`Interest-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(10, 40, by = 5))
ggplot(data=exchangerates,aes(x=Date,group=1))+
geom_line(aes(y=`Exchange-rates`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(3, 8, by = 1))
ggplot(data=consumerconfidenceindex,aes(x=Date,group=1))+
geom_line(aes(y=`Consumer-confidence-index`))+
scale_x_date(date_breaks="1 year", date_labels="%Y")+
scale_y_continuous(breaks=seq(75, 100, by = 5))
fit_month<-lm (`Second-hand-sales`~`Interest-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`,secondhandsales)
summary(fit_month)
secondhandsales[,trend_comp:=1:.N]
secondhandsales[,Year:=year(Date)]
secondhandsales[,Month:=as.factor(month(Date))]
secondhandsales[64:65,remove_seasonality:=1]
secondhandsales[is.na(remove_seasonality)==T,remove_seasonality:=0]
secondhandsales
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp,secondhandsales)
summary(fit_month)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+`Exchange-rates`+as.factor(Month)+Year+trend_comp+as.factor(remove_seasonality),secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Exchange-rates`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Consumer-confidence-index`+trend_comp+Month+Year,secondhandsales)
summary(fit_month)
plot(fit_month$residual)
fit_month<-lm (`Second-hand-sales`~`Interest-rates`+`Exchange-rates`+as.factor(Month)+Year+as.factor(remove_seasonality),secondhandsales)
summary(fit_month)
plot(fit_month$residual)
acf(secondhandsales[,2],lag.max = 24)
ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Exchange-rates`)
ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Interest-rates`)
ccf(secondhandsales$`Second-hand-sales`,secondhandsales$`Consumer-confidence-index`)
plot(secondhandsales[,list(`Second-hand-sales`,interestrates)])
plot(secondhandsales[,list(`Second-hand-sales`,exchangerates)])
plot(secondhandsales[,list(`Second-hand-sales`,consumerconfidenceindex)])
plot(secondhandsales[,list(`Second-hand-sales`,residual=fit_month$residual)])
secondhandsales[,fitted:=fitted(fit_month)]
secondhandsales[,residual:=residuals(fit_month)]
t12 <- "2020-12-01"
secondhandsales <- rbind(secondhandsales,data.table(Date = as.Date(t12)),fill = TRUE)
secondhandsales[.N,remove_seasonality:=0]
secondhandsales[.N,trend_comp:=72]
secondhandsales[.N,Month:=12]
secondhandsales[.N,Year:=2020]
secondhandsales[.N,`Interest-rates`:= secondhandsales[.N-1,`Interest-rates`]]
secondhandsales[.N,`Exchange-rates`:= secondhandsales[.N-1,`Exchange-rates`]]
secondhandsales[.N,`Consumer-confidence-index`:=secondhandsales[.N-1,`Consumer-confidence-index`]]
predict(fit_month,secondhandsales[is.na(fitted)==T])
secondhandsales[is.na(fitted)==T,fitted:=predict(fit_month,secondhandsales[is.na(fitted)==T])]
cols <- c("predicted" = "orange", "actual" = "black")
ggplot() +
geom_line(data = secondhandsales, aes(x = trend_comp, y = fitted,color = "predicted")) +
geom_line(data = secondhandsales, aes(x = trend_comp, y = `Second-hand-sales`,color = "actual")) +
xlab('Date(months)') +
ylab('Second hand sales') +
scale_color_manual(values = cols)
tail(secondhandsales)
